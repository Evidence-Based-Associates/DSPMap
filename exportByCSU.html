<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Export Providers by Service and CSU</title>
    <script src="globals.js?v=08.20.2021-0"></script> 
</head>
<body>
    <script>
        const providers = dspsXML.getElementsByTagName("Provider");
        const services = dspsXML.getElementsByTagName("Service");
        const locations = dspsXML.getElementsByTagName("FIPs");
        let csvHeaders = "DSP!Service Name!CSU9!CSU15!CSU16!CSU17!CSU18!CSU19!CSU20!CSU21!CSU22!CSU23!CSU24!CSU25!CSU26!CSU27!CSU28!CSU29!CSU30!CSU31\n";
        document.write(csvHeaders);
        document.write("<br/>")
        let csvData = "";
        for (let i = 0; i < providers.length; i++) {
            const providerServices = providers[i].getElementsByTagName("Service");
            for (let j = 0; j < providerServices.length; j++) {
                document.write(providers[i].childNodes[1].innerHTML + "!");
                document.write(providerServices[j].getAttribute("serviceName") + "!");
                const serviceFIPS = providerServices[j].getElementsByTagName("FIPs")
                console.log(serviceFIPS);
                document.write("<br/>")
            }
            
            
            //console.log(providerServices)
            
        }
        document.write(csvData);
    </script>
</body>
</html>